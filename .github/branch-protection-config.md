# üõ°Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞—â–∏—Ç—ã –≤–µ—Ç–æ–∫

## üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞—â–∏—Ç–µ –≤–µ—Ç–æ–∫ main –∏ testing

### üîê –í–µ—Ç–∫–∞ `main` (–ü—Ä–æ–¥–∞–∫—à–µ–Ω)

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞—â–∏—Ç—ã:**
- ‚úÖ **Require a pull request before merging**
  - Required approving reviews: **2**
  - Dismiss stale reviews: **–í–∫–ª—é—á–µ–Ω–æ**
  - Require review from code owners: **–í–∫–ª—é—á–µ–Ω–æ**
  
- ‚úÖ **Require status checks to pass before merging**
  - Require branches to be up to date: **–í–∫–ª—é—á–µ–Ω–æ**
  - Status checks:
    - `tests` (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥—É–ª–µ–π)
    - `security-scan` (–ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
    - `lint` (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∏–ª—è –∫–æ–¥–∞)

- ‚úÖ **Require conversation resolution before merging**

- ‚úÖ **Restrict pushes that create files larger than 100MB**

- ‚úÖ **Require signed commits**

- ‚úÖ **Lock branch** (—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ PR)

### üß™ –í–µ—Ç–∫–∞ `testing` (–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞—â–∏—Ç—ã:**
- ‚úÖ **Require a pull request before merging**
  - Required approving reviews: **1**
  - Dismiss stale reviews: **–í–∫–ª—é—á–µ–Ω–æ**
  
- ‚úÖ **Require status checks to pass before merging**
  - Status checks:
    - `tests` (–±–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã)
    - `build` (—Å–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞)

- ‚úÖ **Restrict pushes that create files larger than 50MB**

- ‚úÖ **Lock branch** (—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ PR)

### üìö –í–µ—Ç–∫–∞ `legacy` (–ê—Ä—Ö–∏–≤)

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞—â–∏—Ç—ã:**
- ‚úÖ **Require a pull request before merging**
  - Required approving reviews: **1**
  
- ‚ö†Ô∏è **Allow force pushes** (—Ç–æ–ª—å–∫–æ –¥–ª—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π)

## üöÄ –ü–æ—à–∞–≥–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ GitHub

### 1Ô∏è‚É£ –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
https://github.com/Abilka94/WoW-Reg-Legion-Bot

### 2Ô∏è‚É£ –û—Ç–∫—Ä–æ–π—Ç–µ Settings
Repository ‚Üí Settings ‚Üí Branches

### 3Ô∏è‚É£ –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è –≤–µ—Ç–∫–∏ `main`
```
Branch name pattern: main
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏:**
- [x] Restrict pushes that create files larger than 100 MB
- [x] Require a pull request before merging
  - [x] Required number of reviewers before merging: 2
  - [x] Dismiss stale reviews when new commits are pushed
  - [x] Require review from code owners
- [x] Require status checks to pass before merging
  - [x] Require branches to be up to date before merging
- [x] Require conversation resolution before merging
- [x] Require signed commits
- [x] Lock branch

### 4Ô∏è‚É£ –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è –≤–µ—Ç–∫–∏ `testing`
```
Branch name pattern: testing
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏:**
- [x] Restrict pushes that create files larger than 50 MB
- [x] Require a pull request before merging
  - [x] Required number of reviewers before merging: 1
  - [x] Dismiss stale reviews when new commits are pushed
- [x] Require status checks to pass before merging
- [x] Lock branch

### 5Ô∏è‚É£ –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è –≤–µ—Ç–∫–∏ `legacy`
```
Branch name pattern: legacy
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏:**
- [x] Require a pull request before merging
  - [x] Required number of reviewers before merging: 1
- [x] Allow force pushes (–¥–ª—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π)

## üîß –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–±: GitHub CLI

–ï—Å–ª–∏ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω GitHub CLI, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã:

```bash
# –ó–∞—â–∏—Ç–∞ –≤–µ—Ç–∫–∏ main
gh api repos/Abilka94/WoW-Reg-Legion-Bot/branches/main/protection \
  --method PUT \
  --field required_status_checks='{"strict":true,"contexts":["tests","security-scan"]}' \
  --field enforce_admins=true \
  --field required_pull_request_reviews='{"required_approving_review_count":2,"dismiss_stale_reviews":true}' \
  --field restrictions=null

# –ó–∞—â–∏—Ç–∞ –≤–µ—Ç–∫–∏ testing
gh api repos/Abilka94/WoW-Reg-Legion-Bot/branches/testing/protection \
  --method PUT \
  --field required_status_checks='{"strict":true,"contexts":["tests","build"]}' \
  --field enforce_admins=true \
  --field required_pull_request_reviews='{"required_approving_review_count":1,"dismiss_stale_reviews":true}' \
  --field restrictions=null
```

## ‚ö° –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ GitHub Actions

–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `.github/workflows/branch-protection.yml` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞—â–∏—Ç—ã –≤–µ—Ç–æ–∫.

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
- ‚ùå **–ü—Ä—è–º—ã–µ push –≤ main –∏ testing –∑–∞–ø—Ä–µ—â–µ–Ω—ã**
- ‚úÖ **–¢–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Pull Request**
- ‚úÖ **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —Ä–µ–≤—å—é –∫–æ–¥–∞**
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏**
- ‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ª—É—á–∞–π–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π**

## üö® –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø

–í —Å–ª—É—á–∞–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç:
1. –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –∑–∞—â–∏—Ç—É –≤–µ—Ç–∫–∏
2. –°–¥–µ–ª–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
3. –°–Ω–æ–≤–∞ –≤–∫–ª—é—á–∏—Ç—å –∑–∞—â–∏—Ç—É

**‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –≤ –∫—Ä–∞–π–Ω–∏—Ö —Å–ª—É—á–∞—è—Ö!**